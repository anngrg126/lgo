$("#edit_story_<%= j @story[:id].to_s %> label.is-invalid-label").removeClass("is-invalid-label");
$("#edit_story_<%= j @story[:id].to_s %> input.is-invalid-input, #new_story textarea.is-invalid-input").removeClass("is-invalid-input");
$("#edit_story_<%= j @story[:id].to_s %> span.form-error").remove("p");
$("#edit_story_<%= j @story[:id].to_s %> span.form-error.is-visible").removeClass("is-visible");


<% if @story.errors.any? %>
  $("#flash_notice").html('<div class="callout alert" data-closable><button class="close-button" aria-label="Dismiss alert" type="button" data-close><span aria-hidden="true">&times;</span></button><p><i class="fi-alert"></i> <%= j flash[:alert] %></p></div>');

  <% field_array = ["title", "body"] %>  
  <% for i in 0..@story.errors.full_messages.length-1 %>
    <% field_array.each do |field| %>
      <% if @story.errors.full_messages[i].downcase.include? field %>
        $('label[for="story_<%= j field%>"]').addClass("is-invalid-label");
        $('#story_<%= j field%>').addClass("is-invalid-input");
        $('#story_<%= j field%>').closest('div').find('span.form-error').addClass("is-visible").html('<p><%= @story.errors.full_messages[i] %></p>');
      <% end %>
    <% end %>
  <% end %>
 
<% else %>
  window.location.href = "<%= @story %>"
<% end %>